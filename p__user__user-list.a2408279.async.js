(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[9271],{16894:function(V,U,e){"use strict";var h=e(54787),P=e(47888);U.ZP=P.Z},55590:function(V,U,e){"use strict";e.d(U,{yC:function(){return C},QX:function(){return z},FO:function(){return $},Vx:function(){return v},a1:function(){return n},Od:function(){return t},F3:function(){return Q},h3:function(){return I}});var h=e(3182),P=e(94043),d=e.n(P),m=e(39031);function C(s){return y.apply(this,arguments)}function y(){return y=(0,h.Z)(d().mark(function s(c){return d().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,m.v_)("/api/users/search",c);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},s)})),y.apply(this,arguments)}function z(s,c){return Z.apply(this,arguments)}function Z(){return Z=(0,h.Z)(d().mark(function s(c,i){return d().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,m.v_)("/api/users/count",c,i);case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},s)})),Z.apply(this,arguments)}function $(s,c){return B.apply(this,arguments)}function B(){return B=(0,h.Z)(d().mark(function s(c,i){return d().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,m.U2)("/api/users/detail?id=".concat(c),{},i);case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},s)})),B.apply(this,arguments)}function v(s){return a.apply(this,arguments)}function a(){return a=(0,h.Z)(d().mark(function s(c){return d().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,m.gz)("/api/users/update",c);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},s)})),a.apply(this,arguments)}function n(s){return u.apply(this,arguments)}function u(){return u=(0,h.Z)(d().mark(function s(c){return d().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,m.v_)("/api/users/create",c);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},s)})),u.apply(this,arguments)}function o(s){return g.apply(this,arguments)}function g(){return g=(0,h.Z)(d().mark(function s(c){return d().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,m.v_)("/api/users/check",c);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},s)})),g.apply(this,arguments)}function t(s,c){return f.apply(this,arguments)}function f(){return f=(0,h.Z)(d().mark(function s(c,i){return d().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,m.IV)("/api/users/delete?id=".concat(c),{},i);case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},s)})),f.apply(this,arguments)}function Q(s){return w.apply(this,arguments)}function w(){return w=(0,h.Z)(d().mark(function s(c){return d().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,m.v_)("/api/roles/search",{pageSize:-1});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},s)})),w.apply(this,arguments)}var I=function(){var s=(0,h.Z)(d().mark(function c(i,r,_){var A,R,l,W,S;return d().wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(A=i.field,R=i.fullField,l=Promise,r){E.next=4;break}return E.abrupt("return",l.reject("".concat(R," is required")));case 4:if(!(r.length<5)){E.next=6;break}return E.abrupt("return",l.reject("".concat(R," must be at least 5 characters")));case 6:return console.log("".concat(R," is valid")),W={},W[A]=r,_._id&&(W._id={$ne:_._id}),E.next=12,o(W);case 12:if(S=E.sent,console.log("res",S),S.status!=="success"){E.next=18;break}return E.abrupt("return",l.reject(S.message));case 18:return E.abrupt("return",l.resolve());case 19:case"end":return E.stop()}},c)}));return function(i,r,_){return s.apply(this,arguments)}}()},72588:function(V,U,e){"use strict";e.r(U);var h=e(14781),P=e(23492),d=e(13062),m=e(71230),C=e(57663),y=e(71577),z=e(89032),Z=e(15746),$=e(47673),B=e(4107),v=e(9715),a=e(86835),n=e(11849),u=e(2824),o=e(34792),g=e(48086),t=e(3182),f=e(71194),Q=e(50146),w=e(94043),I=e.n(w),s=e(57119),c=e(49101),i=e(67294),r=e(75362),_=e(16894),A=e(43581),R=e(55590),l=e(85893),W=function(E){var X=Q.Z.confirm,F=E.elementId,N=function(j){X({title:"Do you Want to delete ".concat(j.name,"?"),icon:(0,l.jsx)(s.Z,{}),content:"".concat(j.name," will be deleted permanently."),okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var k=(0,t.Z)(I().mark(function G(){var L;return I().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return console.log("OK"),K.next=3,(0,R.Od)(j._id);case 3:L=K.sent,L.success&&(g.default.success(L.message),setFetchRoles(!0));case 5:case"end":return K.stop()}},G)}));function ee(){return k.apply(this,arguments)}return ee}(),onCancel:function(){console.log("Cancel")}})},x=(0,A.md)(),Y=x.canShow(F);if(Y){var q=x.isDisabled(F);return q?(0,l.jsx)("span",{children:"Delete"}):(0,l.jsx)("a",{onClick:function(){N(E.record)},children:"Delete"},"config")}return null},S=function(){var E=(0,i.useRef)(),X=(0,A.md)(),F=(0,i.useState)({data:[]}),N=(0,u.Z)(F,2),x=N[0],Y=N[1],q=(0,i.useState)(1),J=(0,u.Z)(q,2),j=J[0],k=J[1],ee=(0,i.useState)({}),G=(0,u.Z)(ee,2),L=G[0],re=G[1],K=(0,i.useState)({}),ae=(0,u.Z)(K,2),oe=ae[0],se=ae[1],ce=(0,i.useState)(0),ue=(0,u.Z)(ce,2),de=ue[0],me=ue[1],fe=(0,i.useState)(!1),_e=(0,u.Z)(fe,2),le=_e[0],H=_e[1],pe=function(){var D=(0,t.Z)(I().mark(function p(){var b,T,O,ne;return I().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return b=g.default.loading("Loading..."),M.prev=1,M.next=4,(0,R.yC)((0,n.Z)((0,n.Z)({current:j,pageSize:10},L),oe));case 4:return T=M.sent,b(),Y(T),H(!1),M.abrupt("return",T);case 11:return M.prev=11,M.t0=M.catch(1),b(),O=JSON.stringify(M.t0),ne=JSON.parse(O),console.log(ne),g.default.error(ne.data.errorMessage),M.abrupt("return",!1);case 19:case"end":return M.stop()}},p,null,[[1,11]])}));return function(){return D.apply(this,arguments)}}(),he=function(){var D=(0,t.Z)(I().mark(function p(){var b;return I().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return O.next=2,(0,R.QX)((0,n.Z)({},L));case 2:b=O.sent,me(b.total);case 4:case"end":return O.stop()}},p)}));return function(){return D.apply(this,arguments)}}();(0,i.useEffect)(function(){le&&pe()},[le]),(0,i.useEffect)(function(){k(1),se(null),H(!0),he()},[L]),(0,i.useEffect)(function(){console.log("checking ","user-list-delete-btn"),X.canShow("user-list-delete-btn")&&console.log("show delete button")},[]);var Ee=a.Z.useForm(),ve=(0,u.Z)(Ee,1),ie=ve[0],ge=function(p){re(p)},be=[{title:"Name",sorter:!0,tip:"Name",render:function(p,b){return(0,l.jsx)("a",{onClick:function(){A.m8.push("/users/edit/".concat(b._id))},children:"".concat(b.firstName," ").concat(b.lastName)})}},{title:"Role",dataIndex:"roleAlias"},{title:"Username",dataIndex:"username"},{title:"Email",dataIndex:"email"},{title:"Phone Number",dataIndex:"phoneNumber"},{title:"Actions",dataIndex:"option",valueType:"option",render:function(p,b){return[(0,l.jsx)(W,{record:b,elementId:"user-list-delete-btn"},"delete")]}}];return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(r.ZP,{children:[(0,l.jsx)(a.Z,{form:ie,name:"advanced_search",className:"ant-advanced-search-form",onFinish:ge,style:{display:"flex","align-items":"left",background:"white",padding:"10px"},children:(0,l.jsxs)(m.Z,{gutter:16,children:[(0,l.jsx)(Z.Z,{flex:6,children:(0,l.jsx)(a.Z.Item,{name:"name",label:"Name",children:(0,l.jsx)(B.Z,{placeholder:"Search keyword for name or alias"})})},"name"),(0,l.jsxs)(Z.Z,{flex:6,children:[(0,l.jsx)(y.Z,{type:"primary",htmlType:"submit",children:"Search"}),(0,l.jsx)(y.Z,{style:{margin:"0 8px"},onClick:function(){ie.resetFields()},children:"Clear"})]})]})}),(0,l.jsx)(_.ZP,{headerTitle:"Users",actionRef:E,rowKey:"_id",search:!1,options:{reload:!1},toolBarRender:function(){return[(0,l.jsxs)(y.Z,{type:"primary",onClick:function(){A.m8.push("/users/new")},children:[(0,l.jsx)(c.Z,{})," New"]},"primary")]},onChange:function(p,b,T){console.log("_sorter",T);var O={};O.sort=T.field,O.order=T.order==="ascend"?1:-1,se(O),H(!0)},onSubmit:function(p){console.log(p),re(p)},dataSource:x.data,columns:be,rowSelection:!1,pagination:!1})]}),(0,l.jsx)(P.Z,{total:de,showSizeChanger:!1,showQuickJumper:!1,showTotal:function(p){return"Total ".concat(p," items")},defaultCurrent:j,onChange:function(p,b){k(p),H(!0)},style:{display:"flex","justify-content":"center","align-items":"center",background:"white",padding:"10px"}})]})};U.default=S},39031:function(V,U,e){"use strict";e.d(U,{U2:function(){return z},v_:function(){return Z},gz:function(){return $},IV:function(){return B}});var h=e(3182),P=e(11849),d=e(94043),m=e.n(d),C=e(11238),y=e(43581);C.ZP.interceptors.request.use(function(v,a){var n=localStorage.getItem("auth");if(n&&JSON.parse(n)){var u=JSON.parse(n),o=u.token;o?a.headers.Authorization="Bearer ".concat(o):a.headers.Authorization=null}return console.log("url","http://localhost:8002",v),a.headers["rbac-client-time"]="".concat(new Date," "),{url:"".concat("http://localhost:8002").concat(v),options:(0,P.Z)((0,P.Z)({},a),{},{interceptors:!0})}}),C.ZP.interceptors.response.use(function(){var v=(0,h.Z)(m().mark(function a(n,u){var o,g;return m().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(n.status!==401){f.next=4;break}return localStorage.removeItem("auth"),y.m8.replace({pathname:"/user/login"}),f.abrupt("return",{name:n.name});case 4:if(n.status!==403){f.next=7;break}return y.m8.replace({pathname:"/exception/403"}),f.abrupt("return",{name:n.name});case 7:if(n.status!==404){f.next=10;break}return y.m8.replace({pathname:"/exception/404"}),f.abrupt("return",{name:n.name});case 10:if(n.status!==400){f.next=18;break}return f.next=13,n.clone().json();case 13:return o=f.sent,console.log("data",o),g=new Error(o.message),g.error=o.error,f.abrupt("return",g);case 18:return f.abrupt("return",n);case 19:case"end":return f.stop()}},a)}));return function(a,n){return v.apply(this,arguments)}}());var z=function(){var v=(0,h.Z)(m().mark(function a(n,u,o){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,C.ZP)(n,(0,P.Z)({method:"GET",params:u,skipErrorHandler:!0},o||{})));case 1:case"end":return t.stop()}},a)}));return function(n,u,o){return v.apply(this,arguments)}}(),Z=function(){var v=(0,h.Z)(m().mark(function a(n,u,o){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,(0,C.ZP)(n,(0,P.Z)({method:"POST",data:u,skipErrorHandler:!0},o||{}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}},a)}));return function(n,u,o){return v.apply(this,arguments)}}(),$=function(){var v=(0,h.Z)(m().mark(function a(n,u,o){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,C.ZP)(n,(0,P.Z)({method:"PUT",data:u,skipErrorHandler:!0},o||{})));case 1:case"end":return t.stop()}},a)}));return function(n,u,o){return v.apply(this,arguments)}}(),B=function(){var v=(0,h.Z)(m().mark(function a(n,u,o){return m().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",(0,C.ZP)(n,(0,P.Z)({method:"DELETE",data:u,skipErrorHandler:!0},o||{})));case 1:case"end":return t.stop()}},a)}));return function(n,u,o){return v.apply(this,arguments)}}()}}]);
