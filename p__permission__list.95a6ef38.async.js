(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[6922],{64317:function(j,I,e){"use strict";var E=e(22122),D=e(28991),c=e(81253),u=e(67294),Z=e(62404),C=e(22270),B=e(66758),U=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","showSearch","options"],W=["fieldProps","children","params","proFieldProps","mode","valueEnum","request","options"],A=u.forwardRef(function(n,v){var _=n.fieldProps,d=n.children,R=n.params,L=n.proFieldProps,T=n.mode,S=n.valueEnum,a=n.request,p=n.showSearch,i=n.options,r=(0,c.Z)(n,U),o=(0,u.useContext)(B.Z);return u.createElement(Z.Z,(0,E.Z)({mode:"edit",valueEnum:(0,C.h)(S),request:a,params:R,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,D.Z)({options:i,mode:T,showSearch:p,getPopupContainer:o.getPopupContainer},_),ref:v,proFieldProps:L},r),d)}),O=u.forwardRef(function(n,v){var _=n.fieldProps,d=n.children,R=n.params,L=n.proFieldProps,T=n.mode,S=n.valueEnum,a=n.request,p=n.options,i=(0,c.Z)(n,W),r=(0,D.Z)({options:p,mode:T||"multiple",labelInValue:!0,showSearch:!0,showArrow:!1,autoClearSearchValue:!0,optionLabelProp:"label"},_),o=(0,u.useContext)(B.Z);return u.createElement(Z.Z,(0,E.Z)({mode:"edit",valueEnum:(0,C.h)(S),request:a,params:R,valueType:"select",filedConfig:{customLightMode:!0},fieldProps:(0,D.Z)({getPopupContainer:o.getPopupContainer},r),ref:v,proFieldProps:L},i),d)}),l=A,t=O,m=l;m.SearchSelect=t,m.displayName="ProFormComponent",I.Z=m},16894:function(j,I,e){"use strict";var E=e(54787),D=e(47888);I.ZP=D.Z},70521:function(j,I,e){"use strict";e.r(I);var E=e(14781),D=e(23492),c=e(13062),u=e(71230),Z=e(57663),C=e(71577),B=e(89032),U=e(15746),W=e(47673),A=e(4107),O=e(9715),l=e(86835),t=e(11849),m=e(34792),n=e(48086),v=e(3182),_=e(71194),d=e(50146),R=e(2824),L=e(94043),T=e.n(L),S=e(57119),a=e(8212),p=e(49101),i=e(67294),r=e(75362),o=e(16894),re=e(64317),z=e(43581),F=e(17945),f=e(85893),ne=function(){var te=(0,i.useRef)(),ae=(0,i.useState)({data:[]}),$=(0,R.Z)(ae,2),se=$[0],ue=$[1],le=(0,i.useState)(1),k=(0,R.Z)(le,2),N=k[0],H=k[1],_e=(0,i.useState)({}),J=(0,R.Z)(_e,2),x=J[0],V=J[1],oe=(0,i.useState)({}),G=(0,R.Z)(oe,2),ie=G[0],Q=G[1],ce=(0,i.useState)(0),Y=(0,R.Z)(ce,2),de=Y[0],pe=Y[1],me=(0,i.useState)(!1),X=(0,R.Z)(me,2),q=X[0],K=X[1],fe=d.Z.confirm,he=function(){var P=(0,v.Z)(T().mark(function s(){var h,M;return T().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,(0,F.F3)();case 2:return h=y.sent,M=h.data.map(function(w){return{label:w.alias,value:w._id,role:w}}),y.abrupt("return",M);case 5:case"end":return y.stop()}},s)}));return function(){return P.apply(this,arguments)}}(),Ee=function(){var P=(0,v.Z)(T().mark(function s(){var h,M,b,y;return T().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return h=n.default.loading("Loading..."),g.prev=1,g.next=4,(0,F.yC)((0,t.Z)((0,t.Z)({current:N,pageSize:10},x),ie));case 4:return M=g.sent,h(),ue(M),K(!1),g.abrupt("return",M);case 11:return g.prev=11,g.t0=g.catch(1),h(),b=JSON.stringify(g.t0),y=JSON.parse(b),console.log(y),n.default.error(y.data.errorMessage),g.abrupt("return",!1);case 19:case"end":return g.stop()}},s,null,[[1,11]])}));return function(){return P.apply(this,arguments)}}(),ve=function(s){fe({title:"Do you Want to delete ".concat(s.name,"?"),icon:(0,f.jsx)(S.Z,{}),content:"".concat(s.name," will be deleted permanently."),okText:"Yes",okType:"danger",cancelText:"No",onOk:function(){var h=(0,v.Z)(T().mark(function b(){var y;return T().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return console.log("OK"),g.next=3,(0,F.Od)(s._id);case 3:y=g.sent,y.success&&(n.default.success(y.message),K(!0));case 5:case"end":return g.stop()}},b)}));function M(){return h.apply(this,arguments)}return M}(),onCancel:function(){console.log("Cancel")}})},Pe=function(){var P=(0,v.Z)(T().mark(function s(){var h;return T().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,(0,F.QX)((0,t.Z)({},x));case 2:h=b.sent,pe(h.total);case 4:case"end":return b.stop()}},s)}));return function(){return P.apply(this,arguments)}}();(0,i.useEffect)(function(){q&&Ee()},[q]),(0,i.useEffect)(function(){H(1),Q(null),K(!0),Pe()},[x]);var ge=l.Z.useForm(),Oe=(0,R.Z)(ge,1),ee=Oe[0],De=function(s){V(s)},Me=[{title:"Resource",dataIndex:"resourceAlias",sorter:!0,tip:"Resource name",render:function(s,h){return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("a",{onClick:function(){z.m8.push("/permissions/edit/".concat(h._id))},children:[(0,f.jsx)(a.Z,{})," "]}),"".concat(h.resourceAlias," (").concat(h.resourceName,")")]})}},{title:"Role",dataIndex:"roleName",renderText:function(s,h){return"".concat(h.roleAlias," (").concat(s,")")}},{title:"Allowed",dataIndex:"isAllowed",valueType:"text",renderText:function(s){return s?"Yes":"No"}},{title:"Disabled",dataIndex:"isDisabled",valueType:"text",renderText:function(s){return s?"Yes":"No"}},{title:"Actions",dataIndex:"option",valueType:"option",render:function(s,h){return[(0,f.jsx)("a",{onClick:function(){ve(h)},children:"Delete"},"config")]}}];return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)(r.ZP,{children:[(0,f.jsx)(l.Z,{form:ee,name:"advanced_search",className:"ant-advanced-search-form",onFinish:De,style:{display:"flex","align-items":"left",background:"white",padding:"10px"},children:(0,f.jsxs)(u.Z,{gutter:4,style:{width:"50%"},children:[(0,f.jsx)(U.Z,{flex:16,children:(0,f.jsx)(l.Z.Item,{name:"name",label:"Name",children:(0,f.jsx)(A.Z,{placeholder:"Search keyword for name or alias"})})},"name"),(0,f.jsx)(U.Z,{flex:8,children:(0,f.jsx)(re.Z,{width:"md",name:"roleId",label:"Roles",request:he,placeholder:"Please select a role"})},"role"),(0,f.jsxs)(U.Z,{flex:8,children:[(0,f.jsx)(C.Z,{type:"primary",htmlType:"submit",children:"Search"}),(0,f.jsx)(C.Z,{style:{margin:"0 8px"},onClick:function(){ee.resetFields()},children:"Clear"})]})]})}),(0,f.jsx)(o.ZP,{headerTitle:"Resources",actionRef:te,rowKey:"_id",search:!1,options:{reload:!1},toolBarRender:function(){return[(0,f.jsxs)(C.Z,{type:"primary",onClick:function(){z.m8.push("/permissions/new")},children:[(0,f.jsx)(p.Z,{})," New"]},"primary")]},onChange:function(s,h,M){console.log("_sorter",M);var b={};b.sort=M.field,b.order=M.order==="ascend"?1:-1,Q(b),K(!0)},onSubmit:function(s){console.log(s),V(s)},dataSource:se.data,columns:Me,rowSelection:!1,pagination:!1})]}),(0,f.jsx)(D.Z,{total:de,showSizeChanger:!1,showQuickJumper:!1,showTotal:function(s){return"Total ".concat(s," items")},defaultCurrent:N,onChange:function(s,h){H(s),K(!0)},style:{display:"flex","justify-content":"center","align-items":"center",background:"white",padding:"10px"}})]})};I.default=ne},17945:function(j,I,e){"use strict";e.d(I,{yC:function(){return Z},QX:function(){return B},FO:function(){return W},Vx:function(){return O},a1:function(){return t},H:function(){return n},Od:function(){return _},jh:function(){return R},F3:function(){return T}});var E=e(3182),D=e(94043),c=e.n(D),u=e(39031);function Z(a){return C.apply(this,arguments)}function C(){return C=(0,E.Z)(c().mark(function a(p){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.v_)("/api/permissions/search",p);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},a)})),C.apply(this,arguments)}function B(a,p){return U.apply(this,arguments)}function U(){return U=(0,E.Z)(c().mark(function a(p,i){return c().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,u.v_)("/api/permissions/count",p,i);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},a)})),U.apply(this,arguments)}function W(a,p){return A.apply(this,arguments)}function A(){return A=(0,E.Z)(c().mark(function a(p,i){return c().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,u.U2)("/api/permissions/detail?id=".concat(p),{},i);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},a)})),A.apply(this,arguments)}function O(a){return l.apply(this,arguments)}function l(){return l=(0,E.Z)(c().mark(function a(p){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.gz)("/api/permissions/update",p);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},a)})),l.apply(this,arguments)}function t(a){return m.apply(this,arguments)}function m(){return m=(0,E.Z)(c().mark(function a(p){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.v_)("/api/permissions/create",p);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},a)})),m.apply(this,arguments)}function n(a){return v.apply(this,arguments)}function v(){return v=(0,E.Z)(c().mark(function a(p){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.v_)("/api/permissions/upsert",p);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},a)})),v.apply(this,arguments)}function _(a,p){return d.apply(this,arguments)}function d(){return d=(0,E.Z)(c().mark(function a(p,i){return c().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,u.IV)("/api/permissions/delete?id=".concat(p),{},i);case 2:return o.abrupt("return",o.sent);case 3:case"end":return o.stop()}},a)})),d.apply(this,arguments)}function R(a){return L.apply(this,arguments)}function L(){return L=(0,E.Z)(c().mark(function a(p){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.v_)("/api/resources/search",{pageSize:-1});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},a)})),L.apply(this,arguments)}function T(a){return S.apply(this,arguments)}function S(){return S=(0,E.Z)(c().mark(function a(p){return c().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,u.v_)("/api/roles/search",{pageSize:-1});case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}},a)})),S.apply(this,arguments)}},39031:function(j,I,e){"use strict";e.d(I,{U2:function(){return B},v_:function(){return U},gz:function(){return W},IV:function(){return A}});var E=e(3182),D=e(11849),c=e(94043),u=e.n(c),Z=e(11238),C=e(43581);Z.ZP.interceptors.request.use(function(O,l){var t=localStorage.getItem("auth");if(t&&JSON.parse(t)){var m=JSON.parse(t),n=m.token;n?l.headers.Authorization="Bearer ".concat(n):l.headers.Authorization=null}return console.log("url","http://localhost:8002",O),l.headers["rbac-client-time"]="".concat(new Date," "),{url:"".concat("http://localhost:8002").concat(O),options:(0,D.Z)((0,D.Z)({},l),{},{interceptors:!0})}}),Z.ZP.interceptors.response.use(function(){var O=(0,E.Z)(u().mark(function l(t,m){var n,v;return u().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:if(t.status!==401){d.next=4;break}return localStorage.removeItem("auth"),C.m8.replace({pathname:"/user/login"}),d.abrupt("return",{name:t.name});case 4:if(t.status!==403){d.next=7;break}return C.m8.replace({pathname:"/exception/403"}),d.abrupt("return",{name:t.name});case 7:if(t.status!==404){d.next=10;break}return C.m8.replace({pathname:"/exception/404"}),d.abrupt("return",{name:t.name});case 10:if(t.status!==400){d.next=18;break}return d.next=13,t.clone().json();case 13:return n=d.sent,console.log("data",n),v=new Error(n.message),v.error=n.error,d.abrupt("return",v);case 18:return d.abrupt("return",t);case 19:case"end":return d.stop()}},l)}));return function(l,t){return O.apply(this,arguments)}}());var B=function(){var O=(0,E.Z)(u().mark(function l(t,m,n){return u().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,Z.ZP)(t,(0,D.Z)({method:"GET",params:m,skipErrorHandler:!0},n||{})));case 1:case"end":return _.stop()}},l)}));return function(t,m,n){return O.apply(this,arguments)}}(),U=function(){var O=(0,E.Z)(u().mark(function l(t,m,n){return u().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,(0,Z.ZP)(t,(0,D.Z)({method:"POST",data:m,skipErrorHandler:!0},n||{}));case 2:return _.abrupt("return",_.sent);case 3:case"end":return _.stop()}},l)}));return function(t,m,n){return O.apply(this,arguments)}}(),W=function(){var O=(0,E.Z)(u().mark(function l(t,m,n){return u().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,Z.ZP)(t,(0,D.Z)({method:"PUT",data:m,skipErrorHandler:!0},n||{})));case 1:case"end":return _.stop()}},l)}));return function(t,m,n){return O.apply(this,arguments)}}(),A=function(){var O=(0,E.Z)(u().mark(function l(t,m,n){return u().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.abrupt("return",(0,Z.ZP)(t,(0,D.Z)({method:"DELETE",data:m,skipErrorHandler:!0},n||{})));case 1:case"end":return _.stop()}},l)}));return function(t,m,n){return O.apply(this,arguments)}}()}}]);
